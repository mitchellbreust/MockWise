commands:
  01_install_node:
    command: |
      curl -fsSL https://deb.nodesource.com/setup_22.x | bash -
      apt-get install -y nodejs

option_settings:
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: nginx
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: "production"
    PORT: "8081"
  aws:elasticbeanstalk:environment:process:default:
    Port: "8081"
    HealthCheckPath: "/health"
    MatcherHTTPCode: "200"

container_commands:
  01_install_frontend_deps:
    command: |
      cd src/client/frontend
      npm install
      npm run build
      cd ../../..
  02_copy_frontend:
    command: |
      mkdir -p dist/public
      cp -r src/client/frontend/dist/* dist/public/
